# 文件指纹

## 原理

 *MD5是message-digest algorithm 5（信息-摘要算法）的缩写，被广泛用于加密和解密技术上，它可以说是文件的“数字指纹”。任何一个文件，无论是可执行程序、图像文件、临时文件或者其他任何类型的文件，也不管它体积多大，都有且只有一个独一无二的MD5信息值，并且如果这个文件被修改过，它的MD5值也将随之改变。因此，我们可以通过对比同一文件的MD5值，来校验这个文件是否被“篡改”过。* 

## 作用

*浏览器本地缓存更新*，*项目内容更新。*

## 内置函数

![文件指纹](F:\我的笔记\image\文件指纹.png)

> chunkhash：打包的入口文件的依赖中只要有一个文件发生了变化，就会改变。
>
> contenthash：指的是文件的实际内容，一般用于图片和字体和样式。
>
> hash：一般不会使用

## 代码

### 出口文件的hash处理：

```js
'use strict'

const path = require("path");
const MiniCssExtractPlugin = require("mini-css-extract-plugin") 

module.exports = {
    entry:{
        search:"./src/search.js",
        index:"./src/index.js"
    },
    output:{
        path:path.join(__dirname,'dist'),
        filename:'[name]_[chunkhash:8].js'
    },
    mode:"production"
};
```

> chunkhash

### 图片和文字的hash处理：

```js
'use strict'

const path = require("path");
const MiniCssExtractPlugin = require("mini-css-extract-plugin") 

module.exports = {
    entry:{
        search:"./src/search.js",
        index:"./src/index.js"
    },
    output:{
        path:path.join(__dirname,'dist'),
        filename:'[name].js'
    },
    mode:"production",
    module:{
        rules: [{
                test:/.(png|jpg|gif|jpeg)$/,
                use:[{
                        loader:"file-loader",
                        options:{
                            name:'[name]_[hash:8].[ext]'
                        }
                }]
            },
            {
                test:/.(woff|woff2|eot|ttf|otf)$/,
                use:[{
                    loader:"file-loader",
                    options:{
                        name:'[name]_[hash:8].[ext]'
                    }
            }]
        }]
    }
};
```

> 这里的**hash**指的就是**contenthash**

### css文件hash处理：

> 依赖：**mini-css-extract-plugin**

```js
'use strict'

const path = require("path");
const MiniCssExtractPlugin = require("mini-css-extract-plugin") 

module.exports = {
    entry:{
        search:"./src/search.js",
        index:"./src/index.js"
    },
    output:{
        path:path.join(__dirname,'dist'),
        filename:'[name].js'
    },
    mode:"production",
    module:{
        rules: [
            {
                test: /\.css$/,
                use:[
                    MiniCssExtractPlugin.loader,
                    "css-loader"
                ]
            },
            {
                test:/\.less$/,
                use:[
                    MiniCssExtractPlugin.loader,
                    "css-loader",
                    "less-loader"
                ]
            }
        ]
    },
    plugins: [
        new MiniCssExtractPlugin({
            filename:"[name]_[contenthash:8].css"
        })
    ]
};
```

> 实际生产时我们不希望css文件dom到style标签里，所以实际的处理情况如上。