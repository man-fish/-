# http 三次握手

http请求只有请求和响应的报文格式，实际的数据传输需要靠tcp连接，在1.1之后tap长连接，http再在其基础上通信，那么这个长连接之前就需要谨慎的确认网络传输是否好用了。

![1563270118105](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1563270118105.png)

为什么要有三次握手，假设我们一个请求从客户端的13867端口到服务器的80端口，在客户端给服务器端发送请求之后，服务端返回数据的过程中数据报丢失了，拿不到数据的客户端会关闭掉自己的端口，而服务器浑然不知，于是乎80端口就这样莫名奇妙的被占用了，造成不必要的浪费。所以就需要通过三次握手来确认网络请求是否畅通，然后在创建tcp连接。

![1563268718051](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1563268718051.png)

第一次握手:
客户端发送一个TCP的SYN标志位置1的包指明客户打算连接的服务器的端口，以及初始序号X,保存在包头的序列号(Sequence Number)字段里。
[![100327002911](http://www.centos.bz/wp-content/uploads/2012/08/100327002911.png)](http://www.centos.bz/wp-content/uploads/2012/08/100327002911.png)
第二次握手:
服务器发回确认包(ACK)应答。即SYN标志位和ACK标志位均为1同时，将确认序号(Acknowledgement Number)设置为客户的I S N加1以.即X+1。
[![100327003054](http://www.centos.bz/wp-content/uploads/2012/08/100327003054.png)](http://www.centos.bz/wp-content/uploads/2012/08/100327003054.png)

第三次握手.
客户端再次发送确认包(ACK) SYN标志位为0,ACK标志位为1.并且把服务器发来ACK的序号字段+1,放在确定字段中发送给对方.并且在数据段放写ISN的+1
[![100327003214](http://www.centos.bz/wp-content/uploads/2012/08/100327003214.png)](http://www.centos.bz/wp-content/uploads/2012/08/100327003214.png)