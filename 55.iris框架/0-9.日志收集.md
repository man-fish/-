> 好的日志记录，有助于开发工作。本节展示在 Iris 框架中 如何写入日志文件。

## 初始化🎧

```go
func main() {
	app := iris.New()
	customLogger := logger.New(logger.Config{
		//状态显示状态代码
		Status: true,
		// IP显示请求的远程地址
		IP: true,
		//方法显示http方法
		Method: true,
		// Path显示请求路径
		Path: true,
		// Query将url查询附加到Path。
		Query: true,
        // Column是否分列显示(更清晰)
        Columns：true，
		//如果不为空然后它的内容来自`ctx.GetHeader（“User-Agent”）
		MessageHeaderKeys: []string{"User-Agent"},
	})
    
	app.Use(customLogger)
	err := app.Run(iris.Addr(":8080"),iris.WithoutServerError())
}
```

效果

```cmd
>"normal
Now listening on: http://localhost:8080
Application started. Press CTRL+C to shut down.
[INFO] 2020/01/07 13:51 200   0s ::1 GET /ping Mozilla/5.0 ......
[ERRO] 2020/01/07 13:57 http: Server closed
>"column
Now listening on: http://localhost:8080
Application started. Press CTRL+C to shut down.
Time                   Status  Latency  IP   Method  Path   HeaderMessage
2020/01/07 - 13:57:45  200     0s       ::1  GET     /ping  Mozilla/5.0......
```

## 使用📸

每一次请求接口都会自动记录一条日志，当然我们也可以使用`ctx.Application().Logger()`手动记录一条日志。

```go
app.Get("/ping", func(ctx iris.Context) {
    ctx.Application().Logger().Infof("Request Url:%s",ctx.Path())
    ctx.WriteString("pong")
})
```

## 写入文件🍳

`SetOutput`方法接受一个`writer`接口我们可以将日志写入任何地方。

```go
func todayFile() string {
	return "./logfiles/log_" + time.Now().Format("2006-01-02") + ".txt"
}

func NewLogfile() *os.File {
	filename := todayFile()
	f,err := os.OpenFile(filename,os.O_CREATE|os.O_WRONLY|os.O_APPEND,0666)
	if err != nil {
		panic(err)
	}
	return f
}

func main() {
	f := NewLogfile()
	defer f.Close()

    app := iris.New()
    app.Use(Logger.New())
	app.Logger().SetOutput(f)

	app.Get("/ping", func(ctx iris.Context) {
		ctx.Application().Logger().Infof("Request Url:%s",ctx.Path())
		ctx.WriteString("pong")
	})
	err := app.Run(iris.Addr(":8080"),iris.WithoutServerError())
}
```

![image-20200107140715546](F:\我的笔记\55.iris框架\assets\image-20200107140715546.png)