# vue-router路由

### 简介

Vue Router 是 [Vue.js](http://cn.vuejs.org/) 官方的路由管理器。它和 Vue.js 的核心深度集成，让构建**单页面应用**变得易如反掌。包含的功能有：

- 嵌套的路由/视图表
- 模块化的、基于组件的路由配置
- 路由参数、查询、通配符
- 基于 Vue.js 过渡系统的视图过渡效果
- 细粒度的导航控制
- 带有自动激活的 CSS class 的链接
- HTML5 历史模式或 hash 模式，在 IE9 中自动降级
- 自定义的滚动条行为

### 注册路由表

**routes.js**

```js
import Todo from "./../resource/assets/todo/todo.vue"
import Login from  "./../resource/assets/login/login.vue"

export default[
    {
        path:'/',
        redirect:'/app'
        //默认的首页
    },
    {
        path:'/app',
        component:Todo,
        name:"app"
    },
    {
        path:'/login',
        component:Login,

    }
]
```

**router.js**

```js
import Router from "vue-router"

import routes from "./routes"

export default() =>{
    return new Router({
        routes
    }) 
}
```

**在全局使用   index.js   **

```js
import Vue from 'vue'
import App from './app.vue'
import VueRouter from "vue-router"
import './assets/style/global.styl'
import createRouter from './../config/router'

Vue.use(VueRouter)

const router = createRouter()

new Vue({
    router,
    render: (h)=>h(App)
}).$mount("#root")
```

**在页面中使用**

```vue
<template>
    <div class="box">
        <Header></Header>
        <router-view/>
        <router-link :to="{name:'app'}">app</router-link> 
        					//对应路由表中app的name
        <router-link to="/login">login</router-link> 
        <Footer></Footer>
    </div>
</template>

<script>
import Header from "./assets/todo/header.vue"
import Footer from "./assets/todo/footer.vue"
import Todo from "./assets/todo/todo.vue"
    
export default {
    components:{
        Header,
        Footer,
        Todo
    }
}
</script>
```

> 因为在路由表里面已经引入过了，在组件中就不用进行引入注册了。

**<router-view/\>**

> 显示你在路由表里面注册的组件。

**<router-link/\>**

> 切换到你在路由表里面组测的组件。

这种注册完之后是默认的hash路由也就是多页面应用模式。

### router实例

```js
import Router from "vue-router"

import routes from "./routes"

export default() =>{
    return new Router({
        routes,
        mode:'history',
        //不使用hash路由（单页应用）
        base:"/vue/",
        //基路由
        linkActiveClass:"active-link",
        //不完全匹配（作用于router-link）
        linkExactActiveClass:"exact-active-link",
        //完全匹配（作用于router-link）
        scrollBehavior(to,from,savedPosition){
            if(savedPosition){
                return savedPosition
            }else{
                return {x:0,y:0}
            }
        },
        //是否记录滚动条位置。
        parseQuery(){
        // 定制query参数，不常用
        },
        stringifyQuery(){
		// 定制query参数，不常用
        },
        failback:true
        //将不支持单页应用的浏览器使用hash模式。(兼容)
    }) 
}
```

### routes配置

```js
import Todo from "./../resource/assets/todo/todo.vue"
import Login from  "./../resource/assets/login/login.vue"

export default[
    {	
        path:'/',
        redirect:'/app'
    },
    {
        path:'/app',
        component:Todo,
        name:'app',
        children:[
             {
                 path:'/test',
                 component:Login
             }
         ]
    },
    {
        path:'/login/:id',
        props:{
            id:213,
        },
        props:(route)=>({
             id:route.query.b
        }),
        component:Login,
        query:{
            name : "111"
        }
    }
]
```

##### children

路由表

```js
export default[
    {
        path:'/app',
        component:Todo,
        name:'app',
        children:[
             {
                 path:'/test',
                 component:Login
             }
         ]
    }
]
```

Todo

```vue
<template>
    <section class="real-app">
        <input type="text" class="add-input" @keyup.enter="addTodo" autofocus placeholder="今天要做点什么呢?" >
        <Item :todo = "todo" v-for = "todo in filterTodos" :key = "todo.id" @del = "deleteTodo"/>
        <Tab :todos="todos" v-model = "todos" :filter="filter" @clearAll="clearAllCompleted" @toggle="switchType"/>
        <router-view />
    </section>
</template>
```

这样你在/app下访问/app/test时，router-view的内容就会显现。

##### 参数传递

**params：**

```js
export default{
    {
        path:'/login/:id',
        component:Login
    }
}
```

```vue
<template>
      <router-view/>
</template>

<script>
import Header from "./assets/todo/header.vue"
import Footer from "./assets/todo/footer.vue"
import Todo from "./assets/todo/todo.vue"
export default {
    components:{
        Header,
        Footer,
        Todo
    },
    mounted(){
        console.log(this.$route)
        //这样你的v组件就必须在vuerouter中注册过了，不好。
        //会提高你的vue项目和vuerouter的耦合度，降低组件的复用性
        //所以不推荐这么做。
    }
}
</script>
```

> 这种是不推荐的。

##### **params-prop**

```js
const User = {
  props: ['id'],
  template: '<div>User {{ id }}</div>'
}
const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User, props: true },

    // 对于包含命名视图的路由，你必须分别为每个命名视图添加 `props` 选项：
    {
      path: '/user/:id',
      components: { default: User, sidebar: Sidebar },
      props: { default: true, sidebar: false }
    }
  ]
})
===================================================================================
export default{
    {
        path:'/login/:id',
        component:Login,
        props:{
            id:213,
        },
        props:(route)=>({
             id:route.query.b
        })
    }
}
//三种传递方式。
```

##### **query**

```js
export default{
    {
        path:'/login/:id',
        component:Login,
        query:{
            name : "111"
        }
    }
}
```

```vue
<template>
      <router-view/>
</template>

<script>
import Header from "./assets/todo/header.vue"
import Footer from "./assets/todo/footer.vue"
import Todo from "./assets/todo/todo.vue"
export default {
    components:{
        Header,
        Footer,
        Todo
    },
    mounted(){
        console.log(this.$route)
        //这样你的v组件就必须在vuerouter中注册过了，不好。
        //会提高你的vue项目和vuerouter的耦合度，降低组件的复用性
        //所以不推荐这么做。
    }
}
</script>
```

> URL `/search?q=vue` 会将 `{query: 'vue'}` 作为属性传递给 `SearchUser` 组件。
>
> 依然会提高耦合度，不推荐。

```js
const User = {
  props: ['id'],
  template: '<div>User {{ id }}</div>'
}

export default{
    {
        path:'/login/:id',
        component:Login,
        props:(route)=>({
             id:route.query.b
        })
    }
}
//三种传递方式。
```

这样就是**'/login?b=1'**传递给**prop.id**

### 页面切换动画

```vue
<template>
    <div class="box">
        <transition name="fade">
                <router-view/>
        </transition>
    </div>
</template>
```

```scss
.fade-enter-active , .fade-leave-active{
    transition: opacity .5s
}
.fade-enter,.fade-leave-to{
    opacity: 0
}
```

> css属性只要在组件渲染之前在全局或者在组件内部存在就行了。（全局样式）

### 一个页面多路由耦合

比如这种aside通过路由控制section。

![多组件路由](F:\我的笔记\image\多组件路由.png)

```js
import Todo from "./../resource/assets/todo/todo.vue"
import Login from  "./../resource/assets/login/login.vue"

export default[
    {
        path:'/login',
        components:{
            default:Todo,
            module2:Login
        },

    }
]
```

```vue
<template>
    <div class="box">
        <Header></Header>
        <router-view/>
        <router-view name = "module2"/>
        <Footer></Footer>
    </div>
</template>
```

### 问题

```js
        devServer:{
            contentBase:path.join(__dirname,"dist"),
            hot:true,
            overlay:{
                errors:true
            },
            historyApiFallback:true
            //没弄懂
        },
```

