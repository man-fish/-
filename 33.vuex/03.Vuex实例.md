# Vuex实例

### State

##### 函数式写法

```js
const store = new Vuex.store({
	state(){
		return{
			a:1
		}
	}
})
```

##### 正常对象写法

```js
const store = new Vuex.store({
	state:{
		a:1
	}
})
```

##### 对应两种暴露方式

```js
const state = () =>({ a:1 })
//这种写法，只用一行的时候会自动作为返回值（括号函数）
```

### Mutations

##### 创建

更改 Vuex 的 **store** 中的状态的唯一方法是提交 **mutation**。Vuex 中的 **mutation** 非常类似于事件：每个 **mutation** 都有一个字符串的 **事件类型 (type)** 和 一个 **回调函数 (handler)**。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数：

```js
const store = new Vuex.Store({
  state: {
    count: 1
  },
  mutations: {
    increment (state) {
      // 变更状态
      state.count++
    }
  }
})
```

##### 调用

你不能直接调用一个 **mutation** **handler**。这个选项更像是事件注册：“当触发一个类型为 `increment` 的 **mutation** 时，调用此函数。”要唤醒一个 **mutation** **handler**，你需要以相应的 type 调用 **store.commit** 方法：

```js
store.commit('increment')
```

##### 提交载荷（Payload）

你可以向 `store.commit` 传入额外的参数，即 mutation 的 **载荷（payload）**：

```js
// ...
mutations: {
  increment (state, n) {
    state.count += n
  }
}
store.commit('increment', 10)
```

在大多数情况下，载荷应该是一个对象，这样可以包含多个字段并且记录的 **mutation** 会更易读：

```js
// ...
mutations: {
  increment (state, {amount}) {
    state.count += amount
  }
}
store.commit('increment', {
  amount: 10
})
```

##### 注意

请使用**mutation**来处理数据，不要在组件中操作**$store**虽然这是可行的。

```js
const isDev = process.env.NODE_ENV === 'development'
export default ()=>{
    return new Vuex.Store({
    	strict:isDev,
        state:defaultState,
        mutations,
        getters
    })
}
```

### Actions

```js
export default{
    updateCountAsync(store,data){
        setTimeout(()=>{
            store.commit('updateCount',{
                num:data.num
            },data.time)
        })
    }
}
```

```js
new Vue({
    mounted(){
        this.$store.dispatch("updateCountAsync",{
            num:5,
            time:2000
        })
    },
})
```

**actions**和**mutation**的传参方式是一样的，区别在于，**mutation**不能接受一个异步函数，而**actions**就是为

了解决这个问题而存在的。

### getters

如果说mutation相当于方法，那么getter就相当于computed。

```js
export default{
    fullName(state){
        return `${state.firstname} ${state.lastname}`
    }
}
```

```js
new Vue({
	computed:{
        fullName(){
            return this.$store.getters.fullName
        }
    }
})
```

```js
this.$store.getters.fullName
```

### 模块化管理你的vuex实例属性

```js
import Vuex from 'vuex'
import defaultState from "./state/state"
import mutations from "./mutation/mutation"
import getters from "./getter/getter"

export default ()=>{
    return new Vuex.Store({
        state:defaultState,
        mutations,
        getters
    })
}
```

```js
export default{
    fullName(state){
        return `${state.firstname} ${state.lastname}`
    }
}
```

### 